# ðŸ  The Balancing House Number Problem

*This problem is originally known as the Ramanujan Street Puzzle.*

## Problem

Imagine a street with houses numbered from 1 to $n$.

Is there a house â€” letâ€™s call it $m$ â€” such that the **sum of all house numbers before $m$** is exactly equal to the **sum of all house numbers after $m$**?

In other words:

$$
\sum_{i=1}^{m-1} i = \sum_{i=m+1}^{n} i
$$

Weâ€™re interested in finding all such house numbers $m$ for which this balance is possible for some $n > m$.

Letâ€™s define a function $f(x)$ that returns the $x$-th such house number $m$.

Grateful to [@dodoturkoz](https://github.com/dodoturkoz) for sharing this problem with me back in the summer of 2021.

## Breaking It Down

$$
\begin{align*}
\sum_{i=1}^{m-1} i &= \sum_{i=m+1}^n i \\
\iff \frac{(m-1)m}{2} &= \frac{n(n+1)}{2} - \frac{m(m+1)}{2} \\
\iff m(m-1) &= n(n+1) - m(m+1) \\
\iff 2m^2 &= n(n+1)
\end{align*}
$$


## What Weâ€™re Actually Solving

So in the end, the problem boils down to:

> Find all integers $m$ for which $$2m^2 = n(n + 1)$$ for some integer $n$.

That is, $2m^2$ must be a **pronic number** â€” a number formed by multiplying two consecutive integers.



## First Few Values

Letâ€™s compute the first few values of $f(x)$, the house numbers that make the sums balance:

| $x$ | $f(x)$ (House number $m$) | Corresponding $n$ |
|--------|-------------------------------|--------------------|
| 1      | 1                             | 1                  |
| 2      | 6                             | 8                  |
| 3      | 35                            | 49                 |
| 4      | 204                           | 288                |
| 5      | 1189                          | 1681               |

The OEIS sequences are [A001109](https://oeis.org/A001109) for $f(x)$ and [A001108](https://oeis.org/A001108) for $n$.


## Why This Is Cool

This little puzzle touches on some elegant mathematical concepts:

- **Triangular numbers**: since $\frac{n(n+1)}{2}$ is the sum of the first $n$ numbers
- **Pronic numbers**: products of consecutive integers like $n(n+1)$
- **Diophantine equations**: solving integer equations under constraints
- **Symmetry and balance**: modeling equilibrium in a discrete system

Itâ€™s a great example of how a simple-sounding question leads into deep number-theoretic territory.

## Pell Equation and Fast Generation of Solutions

Starting from the balancing condition

$$
\begin{align*}
2m^2 &= n(n+1) \\
\implies 8m^2 &= 4n^2 + 4n \\
\implies 8m^2 + 1 &= (2n + 1)^2
\end{align*}
$$

Set

$$
X = 2n + 1, \quad Y = m,
$$

to rewrite the equation as the Pell equation

$$
X^2 - 8Y^2 = 1.
$$

> A **Pell equation** is a Diophantine equation of the form
>
> $$
> X^2 - D Y^2 = 1,
> $$
> 
> with $D$ a positive nonsquare integer - in this case $D = 8$.

The fundamental solution is

$$
(X_1, Y_1) = (3, 1),
$$

and all solutions $(X_k, Y_k)$ are generated by

$$
\begin{pmatrix} X_{k+1} \\ Y_{k+1} \end{pmatrix} =
\begin{pmatrix}
3 & 8 \\
1 & 3
\end{pmatrix}
\begin{pmatrix} X_k \\ Y_k \end{pmatrix}.
$$

Each solution corresponds to

$$
m = Y_k, \quad n = \frac{X_k - 1}{2},
$$

so the sequence of balancing house numbers $m$ is given by the Pell solutions $Y_k$, enabling very fast computation via this recurrence.


## Try It Yourself: Python Code


Hereâ€™s a Python function that generates the first $k$ valid house numbers:

```python
def balancing_house_numbers(k):
    """
    Return the first k positive integers m such that
    2*m**2 = n*(n+1) for some integer n.
    This uses the Pell recurrence for X^2 - 8Y^2 = 1 with (X1,Y1)=(3,1),
    where Y_k = m and n = (X_k - 1)//2.
    """
    results = []
    # Pell initialization: X0=1, Y0=0 yields trivial solution; start at the fundamental one:
    X, Y = 3, 1   # first nontrivial solution X1=3, Y1=1 => m=1, n=1
    while len(results) < k:
        m = Y
        results.append(m)
        # next Pell solution: (X_{t+1}, Y_{t+1}) = (3X_t + 8Y_t, X_t + 3Y_t)
        X, Y = 3*X + 8*Y, X + 3*Y
    return results

# Example: first 10 balancing house numbers
print(balancing_house_numbers(10))
```

For an O(1) time solution see [balancing-house-numbers-in-constant-time.md](balancing-house-numbers-in-constant-time.md)


## References

Waldschmidt, M. (2022, November). On the Ramanujan street puzzle of Prasanta Chandra Mahalanobis. Lecture at Cochin University of Science and Technology (CUSAT). Retrieved from [http://www.imj-prg.fr/~michel.waldschmidt/](http://www.imj-prg.fr/~michel.waldschmidt/)
